<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>波本本的分享空间</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6b8cbc;
            --accent-color: #ff7e5f;
            --light-color: #f8f9fa;
            --dark-color: #333;
            --gray-color: #6c757d;
            --border-radius: 12px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        body {
            background-color: #f0f2f5;
            color: var(--dark-color);
            min-height: 100vh;
            padding-top: 80px;
            background-image: url('');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            transition: var(--transition);
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* 头部样式 */
        header {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 80px;
            display: flex;
            align-items: center;
            box-shadow: var(--box-shadow);
            z-index: 1000;
            padding: 0 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .logo img {
            height: 50px;
            width: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-color);
        }
        
        /* 导航标签 */
        .tabs {
            display: flex;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
        }
        
        .tab {
            flex: 1;
            padding: 18px 10px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            color: var(--gray-color);
            border-bottom: 3px solid transparent;
        }
        
        .tab:hover {
            background-color: rgba(74, 111, 165, 0.05);
            color: var(--primary-color);
        }
        
        .tab.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            background-color: rgba(74, 111, 165, 0.1);
        }
        
        .tab i {
            margin-right: 8px;
            font-size: 1.1rem;
        }
        
        /* 内容区域 */
        .content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .content-header h2 {
            color: var(--primary-color);
            font-size: 1.8rem;
        }
        
        .btn {
            padding: 12px 24px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .btn-accent {
            background-color: var(--accent-color);
        }
        
        .btn-accent:hover {
            background-color: #ff6b4a;
        }
        
        /* 数据展示区域 */
        .data-container {
            display: grid;
            gap: 20px;
            margin-bottom: 40px;
        }
        
        /* 图片分享样式 */
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
        }
        
        .image-card {
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }
        
        .image-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
        
        .image-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            cursor: pointer;
        }
        
        .image-info {
            padding: 20px;
        }
        
        .image-info h3 {
            margin-bottom: 10px;
            color: var(--dark-color);
        }
        
        .image-detail {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--gray-color);
            margin-bottom: 8px;
        }
        
        .image-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            border: none;
            transition: var(--transition);
        }
        
        .edit-btn {
            background-color: rgba(74, 111, 165, 0.1);
            color: var(--primary-color);
        }
        
        .edit-btn:hover {
            background-color: rgba(74, 111, 165, 0.2);
        }
        
        .delete-btn {
            background-color: rgba(255, 126, 95, 0.1);
            color: var(--accent-color);
        }
        
        .delete-btn:hover {
            background-color: rgba(255, 126, 95, 0.2);
        }
        
        /* 表单样式 */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .form-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .form-card h3 {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            color: var(--primary-color);
        }
        
        .form-detail {
            margin-bottom: 12px;
            display: flex;
        }
        
        .form-label {
            font-weight: 600;
            min-width: 100px;
            color: var(--gray-color);
        }
        
        .form-value {
            flex: 1;
        }
        
        /* 模态框样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            padding: 25px 30px 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            color: var(--primary-color);
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray-color);
            transition: var(--transition);
        }
        
        .close-btn:hover {
            color: var(--dark-color);
        }
        
        .modal-body {
            padding: 20px 30px 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.2);
        }
        
        .file-upload {
            border: 2px dashed #ddd;
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .file-upload:hover {
            border-color: var(--primary-color);
            background-color: rgba(74, 111, 165, 0.02);
        }
        
        .file-input {
            display: none;
        }
        
        .file-label {
            display: block;
            cursor: pointer;
            color: var(--gray-color);
        }
        
        .file-label i {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 25px;
        }
        
        /* 密码模态框 */
        .password-modal {
            max-width: 400px;
        }
        
        /* 设置页面样式 */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .setting-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }
        
        .setting-preview {
            width: 100px;
            height: 100px;
            border-radius: var(--border-radius);
            object-fit: cover;
            margin: 15px 0;
            border: 2px solid #eee;
        }
        
        /* 戳戳我页面样式 */
        .poke-grid {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
        }
        
        .poke-image {
            max-width: 400px;
            max-height: 400px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            cursor: pointer;
        }
        
        /* 图片放大查看 */
        .image-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .image-viewer.active {
            display: flex;
        }
        
        .viewer-image {
            max-width: 90%;
            max-height: 80%;
            object-fit: contain;
        }
        
        .viewer-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
        }
        
        /* 空状态 */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray-color);
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #ddd;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex: 0 0 calc(50% - 2px);
                padding: 15px 5px;
                font-size: 0.9rem;
            }
            
            .content-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .image-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }
        
        @media (max-width: 480px) {
            .tab {
                flex: 0 0 100%;
            }
            
            .modal-content {
                padding: 10px;
            }
            
            .modal-body {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- 网站头部 -->
    <header>
        <div class="container">
            <div class="logo">
                <img id="site-logo" src="" alt="波本本logo">
                <span>波本本的分享空间</span>
            </div>
        </div>
    </header>
    
    <main class="container">
        <!-- 标签导航 -->
        <div class="tabs">
            <div class="tab active" data-tab="image-share">
                <i class="fas fa-images"></i>图片分享
            </div>
            <div class="tab" data-tab="diary">
                <i class="fas fa-book"></i>流水账
            </div>
            <div class="tab" data-tab="send">
                <i class="fas fa-paper-plane"></i>发片
            </div>
            <div class="tab" data-tab="register">
                <i class="fas fa-clipboard-list"></i>登记
            </div>
            <div class="tab" data-tab="settings">
                <i class="fas fa-cog"></i>设置
            </div>
            <div class="tab" data-tab="poke">
                <i class="fas fa-hand-pointer"></i>戳戳我
            </div>
        </div>
        
        <!-- 图片分享页面 -->
        <section id="image-share" class="content active">
            <div class="content-header">
                <h2><i class="fas fa-images"></i> 图片分享</h2>
                <button class="btn btn-add-image">
                    <i class="fas fa-plus"></i> 上传图片
                </button>
            </div>
            
            <div class="data-container">
                <div class="image-grid" id="image-list">
                    <!-- 图片将通过JS动态添加 -->
                </div>
            </div>
        </section>
        
        <!-- 流水账页面 -->
        <section id="diary" class="content">
            <div class="content-header">
                <h2><i class="fas fa-book"></i> 流水账</h2>
                <button class="btn btn-add-diary">
                    <i class="fas fa-plus"></i> 添加流水账
                </button>
            </div>
            
            <div class="data-container">
                <div class="form-grid" id="diary-list">
                    <!-- 流水账将通过JS动态添加 -->
                </div>
            </div>
        </section>
        
        <!-- 发片页面 -->
        <section id="send" class="content">
            <div class="content-header">
                <h2><i class="fas fa-paper-plane"></i> 发片</h2>
                <button class="btn btn-add-send">
                    <i class="fas fa-plus"></i> 添加发片
                </button>
            </div>
            
            <div class="data-container">
                <div class="form-grid" id="send-list">
                    <!-- 发片数据将通过JS动态添加 -->
                </div>
            </div>
        </section>
        
        <!-- 登记页面 -->
        <section id="register" class="content">
            <div class="content-header">
                <h2><i class="fas fa-clipboard-list"></i> 登记</h2>
                <button class="btn btn-add-register">
                    <i class="fas fa-plus"></i> 添加登记
                </button>
            </div>
            
            <div class="data-container">
                <div class="form-grid" id="register-list">
                    <!-- 登记数据将通过JS动态添加 -->
                </div>
            </div>
        </section>
        
        <!-- 设置页面 -->
        <section id="settings" class="content">
            <div class="content-header">
                <h2><i class="fas fa-cog"></i> 设置</h2>
            </div>
            
            <div class="data-container">
                <div class="settings-grid">
                    <div class="setting-card">
                        <h3><i class="fas fa-image"></i> LOGO设置</h3>
                        <p>支持格式：JPG、JPEG、PNG</p>
                        <p>建议尺寸：75cm * 75cm</p>
                        <div id="logo-preview-container">
                            <img id="logo-preview" class="setting-preview" src="" alt="LOGO预览">
                        </div>
                        <div class="image-actions">
                            <button class="btn action-btn edit-btn" id="upload-logo-btn">
                                <i class="fas fa-upload"></i> 上传LOGO
                            </button>
                            <button class="btn action-btn delete-btn" id="delete-logo-btn">
                                <i class="fas fa-trash"></i> 删除LOGO
                            </button>
                        </div>
                    </div>
                    
                    <div class="setting-card">
                        <h3><i class="fas fa-image"></i> 背景设置</h3>
                        <p>支持格式：JPG、JPEG、PNG</p>
                        <div id="bg-preview-container">
                            <img id="bg-preview" class="setting-preview" src="" alt="背景预览">
                        </div>
                        <div class="image-actions">
                            <button class="btn action-btn edit-btn" id="upload-bg-btn">
                                <i class="fas fa-upload"></i> 上传背景
                            </button>
                            <button class="btn action-btn delete-btn" id="delete-bg-btn">
                                <i class="fas fa-trash"></i> 删除背景
                            </button>
                        </div>
                    </div>
                    
                    <div class="setting-card">
                        <h3><i class="fas fa-hand-pointer"></i> 戳戳我设置</h3>
                        <p>管理戳戳我页面的图片</p>
                        <div class="image-actions">
                            <button class="btn action-btn edit-btn" id="manage-poke-btn">
                                <i class="fas fa-edit"></i> 管理戳戳我
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 戳戳我页面 -->
        <section id="poke" class="content">
            <div class="content-header">
                <h2><i class="fas fa-hand-pointer"></i> 戳戳我</h2>
                <button class="btn btn-add-poke">
                    <i class="fas fa-plus"></i> 上传图片
                </button>
            </div>
            
            <div class="data-container">
                <div class="poke-grid" id="poke-container">
                    <!-- 戳戳我图片将通过JS动态添加 -->
                </div>
            </div>
        </section>
    </main>
    
    <!-- 图片上传模态框 -->
    <div id="image-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>上传图片</h3>
                <button class="close-btn" id="close-image-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="image-upload-form">
                    <div class="form-group">
                        <label for="image-upload">图片（最多5张）</label>
                        <div class="file-upload">
                            <label for="image-upload" class="file-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>点击选择图片，支持JPG、JPEG、PNG格式</p>
                                <p>已选择: <span id="image-count">0</span> 张图片</p>
                            </label>
                            <input type="file" id="image-upload" class="file-input" accept=".jpg,.jpeg,.png" multiple>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="image-title">图片标题</label>
                        <input type="text" id="image-title" class="form-control" placeholder="请输入图片标题" maxlength="30" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="image-location">上传地点</label>
                        <input type="text" id="image-location" class="form-control" placeholder="格式：省、市、区、街道" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="image-note">备注（最多30个字）</label>
                        <textarea id="image-note" class="form-control" rows="3" placeholder="请输入备注" maxlength="30"></textarea>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn action-btn edit-btn" id="cancel-image">取消</button>
                        <button type="submit" class="btn btn-accent">上传图片</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 流水账上传模态框 -->
    <div id="diary-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>添加流水账</h3>
                <button class="close-btn" id="close-diary-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="diary-upload-form">
                    <div class="form-group">
                        <label for="diary-title">标题</label>
                        <input type="text" id="diary-title" class="form-control" placeholder="请输入标题" maxlength="30" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="diary-content">流水账内容（最多30个字）</label>
                        <textarea id="diary-content" class="form-control" rows="4" placeholder="请输入流水账内容" maxlength="30" required></textarea>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn action-btn edit-btn" id="cancel-diary">取消</button>
                        <button type="submit" class="btn btn-accent">添加流水账</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 发片上传模态框 -->
    <div id="send-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>添加发片</h3>
                <button class="close-btn" id="close-send-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="send-upload-form">
                    <div class="form-group">
                        <label for="send-location">上传地址</label>
                        <input type="text" id="send-location" class="form-control" placeholder="格式：省、市、区、街道" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="send-image">图片</label>
                        <div class="file-upload">
                            <label for="send-image" class="file-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>点击选择图片，支持JPG、JPEG、PNG格式</p>
                            </label>
                            <input type="file" id="send-image" class="file-input" accept=".jpg,.jpeg,.png">
                        </div>
                        <div id="send-preview"></div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn action-btn edit-btn" id="cancel-send">取消</button>
                        <button type="submit" class="btn btn-accent">添加发片</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 登记上传模态框 -->
    <div id="register-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>添加登记</h3>
                <button class="close-btn" id="close-register-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="register-upload-form">
                    <div class="form-group">
                        <label for="register-number">编号</label>
                        <input type="text" id="register-number" class="form-control" placeholder="请输入编号" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="register-send-date">发片日期</label>
                        <input type="date" id="register-send-date" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="register-location">上传地址</label>
                        <input type="text" id="register-location" class="form-control" placeholder="格式：省、市、区、街道" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="register-image">图片</label>
                        <div class="file-upload">
                            <label for="register-image" class="file-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>点击选择图片，支持JPG、JPEG、PNG格式</p>
                            </label>
                            <input type="file" id="register-image" class="file-input" accept=".jpg,.jpeg,.png">
                        </div>
                        <div id="register-preview"></div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn action-btn edit-btn" id="cancel-register">取消</button>
                        <button type="submit" class="btn btn-accent">添加登记</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 戳戳我上传模态框 -->
    <div id="poke-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>上传戳戳我图片</h3>
                <button class="close-btn" id="close-poke-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="poke-upload-form">
                    <div class="form-group">
                        <label for="poke-image">图片</label>
                        <div class="file-upload">
                            <label for="poke-image" class="file-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>点击选择图片，支持JPG、JPEG、PNG格式</p>
                            </label>
                            <input type="file" id="poke-image" class="file-input" accept=".jpg,.jpeg,.png">
                        </div>
                        <div id="poke-preview"></div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn action-btn edit-btn" id="cancel-poke">取消</button>
                        <button type="submit" class="btn btn-accent">上传图片</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- LOGO上传模态框 -->
    <div id="logo-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>上传LOGO</h3>
                <button class="close-btn" id="close-logo-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="logo-upload-form">
                    <div class="form-group">
                        <label for="logo-image">LOGO图片</label>
                        <div class="file-upload">
                            <label for="logo-image" class="file-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>点击选择图片，支持JPG、JPEG、PNG格式</p>
                                <p>建议尺寸：75cm * 75cm</p>
                            </label>
                            <input type="file" id="logo-image" class="file-input" accept=".jpg,.jpeg,.png">
                        </div>
                        <div id="logo-upload-preview"></div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn action-btn edit-btn" id="cancel-logo">取消</button>
                        <button type="submit" class="btn btn-accent">上传LOGO</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 背景上传模态框 -->
    <div id="bg-upload-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>上传背景图片</h3>
                <button class="close-btn" id="close-bg-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="bg-upload-form">
                    <div class="form-group">
                        <label for="bg-image">背景图片</label>
                        <div class="file-upload">
                            <label for="bg-image" class="file-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>点击选择图片，支持JPG、JPEG、PNG格式</p>
                            </label>
                            <input type="file" id="bg-image" class="file-input" accept=".jpg,.jpeg,.png">
                        </div>
                        <div id="bg-upload-preview"></div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn action-btn edit-btn" id="cancel-bg">取消</button>
                        <button type="submit" class="btn btn-accent">上传背景</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 密码验证模态框 -->
    <div id="password-modal" class="modal">
        <div class="modal-content password-modal">
            <div class="modal-header">
                <h3>请输入管理密码</h3>
                <button class="close-btn" id="close-password-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <input type="password" id="password-input" class="form-control" placeholder="请输入密码">
                    <p id="password-error" style="color: #ff6b4a; margin-top: 10px; display: none;">密码错误，请重新输入</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn action-btn edit-btn" id="cancel-password">取消</button>
                    <button type="button" class="btn btn-accent" id="submit-password">确认</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 图片查看器 -->
    <div id="image-viewer" class="image-viewer">
        <button class="viewer-close">&times;</button>
        <img class="viewer-image" src="" alt="预览图片">
    </div>
    
    <script>
        // 全局变量
        const PASSWORD = "740302"; // 默认密码
        let currentTab = "image-share";
        let currentModal = null;
        let editingId = null;
        let editingType = null;
        
        // 从localStorage加载当前标签页
        function loadCurrentTab() {
            const savedTab = localStorage.getItem("currentTab");
            if (savedTab) {
                switchTab(savedTab);
            }
        }
        
        // 标签切换功能
        function switchTab(tabId) {
            // 更新当前标签
            currentTab = tabId;
            localStorage.setItem("currentTab", tabId);
            
            // 更新标签样式
            document.querySelectorAll(".tab").forEach(tab => {
                if (tab.dataset.tab === tabId) {
                    tab.classList.add("active");
                } else {
                    tab.classList.remove("active");
                }
            });
            
            // 更新内容显示
            document.querySelectorAll(".content").forEach(content => {
                if (content.id === tabId) {
                    content.classList.add("active");
                } else {
                    content.classList.remove("active");
                }
            });
        }
        
        // 密码验证
        function showPasswordModal(callback) {
            document.getElementById("password-modal").classList.add("active");
            document.getElementById("password-input").focus();
            
            const submitPassword = () => {
                const password = document.getElementById("password-input").value;
                if (password === PASSWORD) {
                    hideModal("password-modal");
                    document.getElementById("password-input").value = "";
                    document.getElementById("password-error").style.display = "none";
                    if (callback) callback();
                } else {
                    document.getElementById("password-error").style.display = "block";
                }
            };
            
            document.getElementById("submit-password").onclick = submitPassword;
            document.getElementById("password-input").onkeydown = (e) => {
                if (e.key === "Enter") submitPassword();
            };
        }
        
        // 显示/隐藏模态框
        function showModal(modalId) {
            document.getElementById(modalId).classList.add("active");
            currentModal = modalId;
        }
        
        function hideModal(modalId) {
            document.getElementById(modalId).classList.remove("active");
            if (modalId === currentModal) {
                currentModal = null;
            }
            
            // 重置表单
            if (modalId.includes("upload-modal")) {
                document.querySelector(`#${modalId} form`).reset();
                if (modalId === "image-upload-modal") {
                    document.getElementById("image-count").textContent = "0";
                }
            }
            
            // 重置编辑状态
            editingId = null;
            editingType = null;
        }
        
        // 格式化日期
        function formatDate(date = new Date()) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${year}年${month}月${day}日 ${hours}:${minutes}`;
        }
        
        // 生成发片编号
        function generateSendNumber() {
            const today = new Date();
            const dateStr = today.getFullYear().toString() + 
                           String(today.getMonth() + 1).padStart(2, '0') + 
                           String(today.getDate()).padStart(2, '0');
            
            // 从localStorage获取当天的发片记录
            const sendItems = JSON.parse(localStorage.getItem("sendItems") || "[]");
            const todayItems = sendItems.filter(item => {
                return item.date && item.date.includes(dateStr.replace(/(\d{4})(\d{2})(\d{2})/, "$1年$2月$3日"));
            });
            
            // 生成序号
            const count = todayItems.length + 1;
            return `${dateStr}${String(count).padStart(3, '0')}`;
        }
        
        // 图片处理
        function previewImage(file, callback) {
            const reader = new FileReader();
            reader.onload = function(e) {
                callback(e.target.result);
            };
            reader.readAsDataURL(file);
        }
        
        // 图片分享功能
        function loadImageShareData() {
            const container = document.getElementById("image-list");
            const items = JSON.parse(localStorage.getItem("imageItems") || "[]");
            
            if (items.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="far fa-images"></i>
                        <h3>暂无图片分享</h3>
                        <p>点击"上传图片"按钮添加第一张图片</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = items.map(item => `
                <div class="image-card" data-id="${item.id}">
                    <img src="${item.image}" class="view-image" alt="${item.title}">
                    <div class="image-info">
                        <h3>${item.title}</h3>
                        <div class="image-detail">
                            <span><i class="far fa-calendar"></i> ${item.date}</span>
                            <span><i class="fas fa-map-marker-alt"></i> ${item.location}</span>
                        </div>
                        <p>${item.note || "无备注"}</p>
                        <div class="image-actions">
                            <button class="action-btn edit-btn edit-image-btn">
                                <i class="fas fa-edit"></i> 修改
                            </button>
                            <button class="action-btn delete-btn delete-image-btn">
                                <i class="fas fa-trash"></i> 删除
                            </button>
                        </div>
                    </div>
                </div>
            `).join("");
            
            // 添加图片点击放大事件
            document.querySelectorAll(".view-image").forEach(img => {
                img.addEventListener("click", function() {
                    document.getElementById("image-viewer").classList.add("active");
                    document.querySelector(".viewer-image").src = this.src;
                });
            });
            
            // 添加编辑和删除事件
            document.querySelectorAll(".edit-image-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    const id = this.closest(".image-card").dataset.id;
                    editImageItem(id);
                });
            });
            
            document.querySelectorAll(".delete-image-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    const id = this.closest(".image-card").dataset.id;
                    if (confirm("确定要删除这张图片吗？")) {
                        deleteImageItem(id);
                    }
                });
            });
        }
        
        function saveImageItem(data) {
            const items = JSON.parse(localStorage.getItem("imageItems") || "[]");
            
            if (editingId) {
                // 编辑现有项
                const index = items.findIndex(item => item.id === editingId);
                if (index !== -1) {
                    items[index] = {...items[index], ...data};
                }
            } else {
                // 添加新项
                data.id = Date.now().toString();
                data.date = formatDate();
                items.unshift(data);
            }
            
            localStorage.setItem("imageItems", JSON.stringify(items));
            loadImageShareData();
        }
        
        function editImageItem(id) {
            const items = JSON.parse(localStorage.getItem("imageItems") || "[]");
            const item = items.find(item => item.id === id);
            
            if (!item) return;
            
            editingId = id;
            editingType = "image";
            
            // 填充表单
            document.getElementById("image-title").value = item.title;
            document.getElementById("image-location").value = item.location;
            document.getElementById("image-note").value = item.note || "";
            
            // 显示模态框
            showPasswordModal(() => {
                showModal("image-upload-modal");
            });
        }
        
        function deleteImageItem(id) {
            const items = JSON.parse(localStorage.getItem("imageItems") || "[]");
            const filtered = items.filter(item => item.id !== id);
            localStorage.setItem("imageItems", JSON.stringify(filtered));
            loadImageShareData();
        }
        
        // 流水账功能
        function loadDiaryData() {
            const container = document.getElementById("diary-list");
            const items = JSON.parse(localStorage.getItem("diaryItems") || "[]");
            
            if (items.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="far fa-clipboard"></i>
                        <h3>暂无流水账</h3>
                        <p>点击"添加流水账"按钮添加第一条记录</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = items.map(item => `
                <div class="form-card" data-id="${item.id}">
                    <h3>${item.title}</h3>
                    <div class="form-detail">
                        <span class="form-label">日期:</span>
                        <span class="form-value">${item.date}</span>
                    </div>
                    <div class="form-detail">
                        <span class="form-label">内容:</span>
                        <span class="form-value">${item.content}</span>
                    </div>
                    <div class="image-actions">
                        <button class="action-btn edit-btn edit-diary-btn">
                            <i class="fas fa-edit"></i> 修改
                        </button>
                        <button class="action-btn delete-btn delete-diary-btn">
                            <i class="fas fa-trash"></i> 删除
                        </button>
                    </div>
                </div>
            `).join("");
            
            // 添加编辑和删除事件
            document.querySelectorAll(".edit-diary-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    const id = this.closest(".form-card").dataset.id;
                    editDiaryItem(id);
                });
            });
            
            document.querySelectorAll(".delete-diary-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    const id = this.closest(".form-card").dataset.id;
                    if (confirm("确定要删除这条流水账吗？")) {
                        deleteDiaryItem(id);
                    }
                });
            });
        }
        
        function saveDiaryItem(data) {
            const items = JSON.parse(localStorage.getItem("diaryItems") || "[]");
            
            if (editingId) {
                // 编辑现有项
                const index = items.findIndex(item => item.id === editingId);
                if (index !== -1) {
                    items[index] = {...items[index], ...data};
                }
            } else {
                // 添加新项
                data.id = Date.now().toString();
                data.date = formatDate();
                items.unshift(data);
            }
            
            localStorage.setItem("diaryItems", JSON.stringify(items));
            loadDiaryData();
        }
        
        function editDiaryItem(id) {
            const items = JSON.parse(localStorage.getItem("diaryItems") || "[]");
            const item = items.find(item => item.id === id);
            
            if (!item) return;
            
            editingId = id;
            editingType = "diary";
            
            // 填充表单
            document.getElementById("diary-title").value = item.title;
            document.getElementById("diary-content").value = item.content;
            
            // 显示模态框
            showPasswordModal(() => {
                showModal("diary-upload-modal");
            });
        }
        
        function deleteDiaryItem(id) {
            const items = JSON.parse(localStorage.getItem("diaryItems") || "[]");
            const filtered = items.filter(item => item.id !== id);
            localStorage.setItem("diaryItems", JSON.stringify(filtered));
            loadDiaryData();
        }
        
        // 发片功能
        function loadSendData() {
            const container = document.getElementById("send-list");
            const items = JSON.parse(localStorage.getItem("sendItems") || "[]");
            
            if (items.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="far fa-paper-plane"></i>
                        <h3>暂无发片记录</h3>
                        <p>点击"添加发片"按钮添加第一条记录</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = items.map(item => `
                <div class="form-card" data-id="${item.id}">
                    <h3>发片编号: ${item.number}</h3>
                    <div class="form-detail">
                        <span class="form-label">日期:</span>
                        <span class="form-value">${item.date}</span>
                    </div>
                    <div class="form-detail">
                        <span class="form-label">地址:</span>
                        <span class="form-value">${item.location}</span>
                    </div>
                    ${item.image ? `<div class="form-detail">
                        <span class="form-label">图片:</span>
                        <span class="form-value">
                            <img src="${item.image}" class="view-image" style="width: 100px; height: auto; cursor: pointer; border-radius: 5px;" alt="发片图片">
                        </span>
                    </div>` : ''}
                    <div class="image-actions">
                        <button class="action-btn edit-btn edit-send-btn">
                            <i class="fas fa-edit"></i> 修改
                        </button>
                        <button class="action-btn delete-btn delete-send-btn">
                            <i class="fas fa-trash"></i> 删除
                        </button>
                    </div>
                </div>
            `).join("");
            
            // 添加图片点击放大事件
            document.querySelectorAll(".view-image").forEach(img => {
                img.addEventListener("click", function() {
                    document.getElementById("image-viewer").classList.add("active");
                    document.querySelector(".viewer-image").src = this.src;
                });
            });
            
            // 添加编辑和删除事件
            document.querySelectorAll(".edit-send-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    const id = this.closest(".form-card").dataset.id;
                    editSendItem(id);
                });
            });
            
            document.querySelectorAll(".delete-send-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    const id = this.closest(".form-card").dataset.id;
                    if (confirm("确定要删除这条发片记录吗？")) {
                        deleteSendItem(id);
                    }
                });
            });
        }
        
        function saveSendItem(data) {
            const items = JSON.parse(localStorage.getItem("sendItems") || "[]");
            
            if (editingId) {
                // 编辑现有项
                const index = items.findIndex(item => item.id === editingId);
                if (index !== -1) {
                    items[index] = {...items[index], ...data};
                }
            } else {
                // 添加新项
                data.id = Date.now().toString();
                data.date = formatDate();
                data.number = generateSendNumber();
                items.unshift(data);
            }
            
            localStorage.setItem("sendItems", JSON.stringify(items));
            loadSendData();
        }
        
        function editSendItem(id) {
            const items = JSON.parse(localStorage.getItem("sendItems") || "[]");
            const item = items.find(item => item.id === id);
            
            if (!item) return;
            
            editingId = id;
            editingType = "send";
            
            // 填充表单
            document.getElementById("send-location").value = item.location;
            
            // 显示预览
            if (item.image) {
                document.getElementById("send-preview").innerHTML = `
                    <p>当前图片:</p>
                    <img src="${item.image}" style="max-width: 200px; margin-top: 10px; border-radius: 5px;">
                `;
            }
            
            // 显示模态框
            showPasswordModal(() => {
                showModal("send-upload-modal");
            });
        }
        
        function deleteSendItem(id) {
            const items = JSON.parse(localStorage.getItem("sendItems") || "[]");
            const filtered = items.filter(item => item.id !== id);
            localStorage.setItem("sendItems", JSON.stringify(filtered));
            loadSendData();
        }
        
        // 登记功能
        function loadRegisterData() {
            const container = document.getElementById("register-list");
            const items = JSON.parse(localStorage.getItem("registerItems") || "[]");
            
            if (items.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="far fa-clipboard"></i>
                        <h3>暂无登记记录</h3>
                        <p>点击"添加登记"按钮添加第一条记录</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = items.map(item => `
                <div class="form-card" data-id="${item.id}">
                    <h3>登记编号: ${item.number}</h3>
                    <div class="form-detail">
                        <span class="form-label">发片日期:</span>
                        <span class="form-value">${item.sendDate}</span>
                    </div>
                    <div class="form-detail">
                        <span class="form-label">登记日期:</span>
                        <span class="form-value">${item.date}</span>
                    </div>
                    <div class="form-detail">
                        <span class="form-label">地址:</span>
                        <span class="form-value">${item.location}</span>
                    </div>
                    ${item.image ? `<div class="form-detail">
                        <span class="form-label">图片:</span>
                        <span class="form-value">
                            <img src="${item.image}" class="view-image" style="width: 100px; height: auto; cursor: pointer; border-radius: 5px;" alt="登记图片">
                        </span>
                    </div>` : ''}
                    <div class="image-actions">
                        <button class="action-btn edit-btn edit-register-btn">
                            <i class="fas fa-edit"></i> 修改
                        </button>
                        <button class="action-btn delete-btn delete-register-btn">
                            <i class="fas fa-trash"></i> 删除
                        </button>
                    </div>
                </div>
            `).join("");
            
            // 添加图片点击放大事件
            document.querySelectorAll(".view-image").forEach(img => {
                img.addEventListener("click", function() {
                    document.getElementById("image-viewer").classList.add("active");
                    document.querySelector(".viewer-image").src = this.src;
                });
            });
            
            // 添加编辑和删除事件
            document.querySelectorAll(".edit-register-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    const id = this.closest(".form-card").dataset.id;
                    editRegisterItem(id);
                });
            });
            
            document.querySelectorAll(".delete-register-btn").forEach(btn => {
                btn.addEventListener("click", function() {
                    const id = this.closest(".form-card").dataset.id;
                    if (confirm("确定要删除这条登记记录吗？")) {
                        deleteRegisterItem(id);
                    }
                });
            });
        }
        
        function saveRegisterItem(data) {
            const items = JSON.parse(localStorage.getItem("registerItems") || "[]");
            
            if (editingId) {
                // 编辑现有项
                const index = items.findIndex(item => item.id === editingId);
                if (index !== -1) {
                    items[index] = {...items[index], ...data};
                }
            } else {
                // 添加新项
                data.id = Date.now().toString();
                data.date = formatDate();
                items.unshift(data);
            }
            
            localStorage.setItem("registerItems", JSON.stringify(items));
            loadRegisterData();
        }
        
        function editRegisterItem(id) {
            const items = JSON.parse(localStorage.getItem("registerItems") || "[]");
            const item = items.find(item => item.id === id);
            
            if (!item) return;
            
            editingId = id;
            editingType = "register";
            
            // 填充表单
            document.getElementById("register-number").value = item.number;
            document.getElementById("register-send-date").value = item.sendDate;
            document.getElementById("register-location").value = item.location;
            
            // 显示预览
            if (item.image) {
                document.getElementById("register-preview").innerHTML = `
                    <p>当前图片:</p>
                    <img src="${item.image}" style="max-width: 200px; margin-top: 10px; border-radius: 5px;">
                `;
            }
            
            // 显示模态框
            showPasswordModal(() => {
                showModal("register-upload-modal");
            });
        }
        
        function deleteRegisterItem(id) {
            const items = JSON.parse(localStorage.getItem("registerItems") || "[]");
            const filtered = items.filter(item => item.id !== id);
            localStorage.setItem("registerItems", JSON.stringify(filtered));
            loadRegisterData();
        }
        
        // 戳戳我功能
        function loadPokeData() {
            const container = document.getElementById("poke-container");
            const items = JSON.parse(localStorage.getItem("pokeItems") || "[]");
            
            if (items.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="far fa-hand-point-up"></i>
                        <h3>暂无戳戳我图片</h3>
                        <p>点击"上传图片"按钮添加第一张图片</p>
                    </div>
                `;
                return;
            }
            
            // 只显示最新的一张图片
            const latestItem = items[0];
            container.innerHTML = `
                <img src="${latestItem.image}" class="poke-image view-image" alt="戳戳我图片">
                <div class="image-actions" style="margin-top: 20px;">
                    <button class="action-btn edit-btn" id="edit-poke-btn">
                        <i class="fas fa-edit"></i> 修改图片
                    </button>
                    <button class="action-btn delete-btn" id="delete-poke-btn">
                        <i class="fas fa-trash"></i> 删除图片
                    </button>
                </div>
            `;
            
            // 添加图片点击放大事件
            document.querySelector(".poke-image").addEventListener("click", function() {
                document.getElementById("image-viewer").classList.add("active");
                document.querySelector(".viewer-image").src = this.src;
            });
            
            // 添加编辑和删除事件
            document.getElementById("edit-poke-btn").addEventListener("click", () => {
                editPokeItem(latestItem.id);
            });
            
            document.getElementById("delete-poke-btn").addEventListener("click", () => {
                if (confirm("确定要删除这张图片吗？")) {
                    deletePokeItem(latestItem.id);
                }
            });
        }
        
        function savePokeItem(data) {
            const items = JSON.parse(localStorage.getItem("pokeItems") || "[]");
            
            if (editingId) {
                // 编辑现有项
                const index = items.findIndex(item => item.id === editingId);
                if (index !== -1) {
                    items[index] = {...items[index], ...data};
                }
            } else {
                // 添加新项
                data.id = Date.now().toString();
                data.date = formatDate();
                items.unshift(data);
            }
            
            localStorage.setItem("pokeItems", JSON.stringify(items));
            loadPokeData();
        }
        
        function editPokeItem(id) {
            const items = JSON.parse(localStorage.getItem("pokeItems") || "[]");
            const item = items.find(item => item.id === id);
            
            if (!item) return;
            
            editingId = id;
            editingType = "poke";
            
            // 显示预览
            if (item.image) {
                document.getElementById("poke-preview").innerHTML = `
                    <p>当前图片:</p>
                    <img src="${item.image}" style="max-width: 200px; margin-top: 10px; border-radius: 5px;">
                `;
            }
            
            // 显示模态框
            showPasswordModal(() => {
                showModal("poke-upload-modal");
            });
        }
        
        function deletePokeItem(id) {
            const items = JSON.parse(localStorage.getItem("pokeItems") || "[]");
            const filtered = items.filter(item => item.id !== id);
            localStorage.setItem("pokeItems", JSON.stringify(filtered));
            loadPokeData();
        }
        
        // 加载LOGO和背景
        function loadSettings() {
            const logo = localStorage.getItem("siteLogo");
            if (logo) {
                document.getElementById("site-logo").src = logo;
                document.getElementById("logo-preview").src = logo;
            }
            
            const bg = localStorage.getItem("siteBackground");
            if (bg) {
                document.body.style.backgroundImage = `url('${bg}')`;
                document.getElementById("bg-preview").src = bg;
            }
        }
        
        // 初始化事件监听
        function initEventListeners() {
            // 标签切换
            document.querySelectorAll(".tab").forEach(tab => {
                tab.addEventListener("click", function() {
                    const tabId = this.dataset.tab;
                    switchTab(tabId);
                });
            });
            
            // 图片分享相关
            document.querySelector(".btn-add-image").addEventListener("click", () => {
                showPasswordModal(() => {
                    showModal("image-upload-modal");
                });
            });
            
            document.getElementById("image-upload").addEventListener("change", function() {
                const count = this.files.length;
                document.getElementById("image-count").textContent = count;
            });
            
            document.getElementById("image-upload-form").addEventListener("submit", function(e) {
                e.preventDefault();
                
                const files = document.getElementById("image-upload").files;
                if (files.length === 0 || files.length > 5) {
                    alert("请选择1-5张图片");
                    return;
                }
                
                const title = document.getElementById("image-title").value.trim();
                const location = document.getElementById("image-location").value.trim();
                const note = document.getElementById("image-note").value.trim();
                
                if (!title || !location) {
                    alert("请填写标题和上传地点");
                    return;
                }
                
                // 只处理第一张图片
                previewImage(files[0], function(imageData) {
                    const data = {
                        image: imageData,
                        title: title,
                        location: location,
                        note: note
                    };
                    
                    saveImageItem(data);
                    hideModal("image-upload-modal");
                });
            });
            
            // 流水账相关
            document.querySelector(".btn-add-diary").addEventListener("click", () => {
                showPasswordModal(() => {
                    showModal("diary-upload-modal");
                });
            });
            
            document.getElementById("diary-upload-form").addEventListener("submit", function(e) {
                e.preventDefault();
                
                const title = document.getElementById("diary-title").value.trim();
                const content = document.getElementById("diary-content").value.trim();
                
                if (!title || !content) {
                    alert("请填写标题和内容");
                    return;
                }
                
                const data = {
                    title: title,
                    content: content
                };
                
                saveDiaryItem(data);
                hideModal("diary-upload-modal");
            });
            
            // 发片相关
            document.querySelector(".btn-add-send").addEventListener("click", () => {
                showPasswordModal(() => {
                    document.getElementById("send-preview").innerHTML = "";
                    showModal("send-upload-modal");
                });
            });
            
            document.getElementById("send-image").addEventListener("change", function() {
                if (this.files.length === 0) return;
                
                previewImage(this.files[0], function(imageData) {
                    document.getElementById("send-preview").innerHTML = `
                        <p>图片预览:</p>
                        <img src="${imageData}" style="max-width: 200px; margin-top: 10px; border-radius: 5px;">
                    `;
                });
            });
            
            document.getElementById("send-upload-form").addEventListener("submit", function(e) {
                e.preventDefault();
                
                const file = document.getElementById("send-image").files[0];
                const location = document.getElementById("send-location").value.trim();
                
                if (!file || !location) {
                    alert("请选择图片并填写上传地址");
                    return;
                }
                
                previewImage(file, function(imageData) {
                    const data = {
                        image: imageData,
                        location: location
                    };
                    
                    saveSendItem(data);
                    hideModal("send-upload-modal");
                });
            });
            
            // 登记相关
            document.querySelector(".btn-add-register").addEventListener("click", () => {
                showPasswordModal(() => {
                    document.getElementById("register-preview").innerHTML = "";
                    showModal("register-upload-modal");
                });
            });
            
            document.getElementById("register-image").addEventListener("change", function() {
                if (this.files.length === 0) return;
                
                previewImage(this.files[0], function(imageData) {
                    document.getElementById("register-preview").innerHTML = `
                        <p>图片预览:</p>
                        <img src="${imageData}" style="max-width: 200px; margin-top: 10px; border-radius: 5px;">
                    `;
                });
            });
            
            document.getElementById("register-upload-form").addEventListener("submit", function(e) {
                e.preventDefault();
                
                const number = document.getElementById("register-number").value.trim();
                const sendDate = document.getElementById("register-send-date").value;
                const location = document.getElementById("register-location").value.trim();
                const file = document.getElementById("register-image").files[0];
                
                if (!number || !sendDate || !location || !file) {
                    alert("请填写所有字段并选择图片");
                    return;
                }
                
                previewImage(file, function(imageData) {
                    const data = {
                        number: number,
                        sendDate: sendDate,
                        location: location,
                        image: imageData
                    };
                    
                    saveRegisterItem(data);
                    hideModal("register-upload-modal");
                });
            });
            
            // 戳戳我相关
            document.querySelector(".btn-add-poke").addEventListener("click", () => {
                showPasswordModal(() => {
                    document.getElementById("poke-preview").innerHTML = "";
                    showModal("poke-upload-modal");
                });
            });
            
            document.getElementById("poke-image").addEventListener("change", function() {
                if (this.files.length === 0) return;
                
                previewImage(this.files[0], function(imageData) {
                    document.getElementById("poke-preview").innerHTML = `
                        <p>图片预览:</p>
                        <img src="${imageData}" style="max-width: 200px; margin-top: 10px; border-radius: 5px;">
                    `;
                });
            });
            
            document.getElementById("poke-upload-form").addEventListener("submit", function(e) {
                e.preventDefault();
                
                const file = document.getElementById("poke-image").files[0];
                
                if (!file) {
                    alert("请选择图片");
                    return;
                }
                
                previewImage(file, function(imageData) {
                    const data = {
                        image: imageData
                    };
                    
                    savePokeItem(data);
                    hideModal("poke-upload-modal");
                });
            });
            
            // 设置相关
            document.getElementById("upload-logo-btn").addEventListener("click", () => {
                showPasswordModal(() => {
                    document.getElementById("logo-upload-preview").innerHTML = "";
                    showModal("logo-upload-modal");
                });
            });
            
            document.getElementById("delete-logo-btn").addEventListener("click", () => {
                if (confirm("确定要删除LOGO吗？")) {
                    localStorage.removeItem("siteLogo");
                    document.getElementById("site-logo").src = "";
                    document.getElementById("logo-preview").src = "";
                }
            });
            
            document.getElementById("upload-bg-btn").addEventListener("click", () => {
                showPasswordModal(() => {
                    document.getElementById("bg-upload-preview").innerHTML = "";
                    showModal("bg-upload-modal");
                });
            });
            
            document.getElementById("delete-bg-btn").addEventListener("click", () => {
                if (confirm("确定要删除背景图片吗？")) {
                    localStorage.removeItem("siteBackground");
                    document.body.style.backgroundImage = "";
                    document.getElementById("bg-preview").src = "";
                }
            });
            
            document.getElementById("manage-poke-btn").addEventListener("click", () => {
                switchTab("poke");
            });
            
            // LOGO上传
            document.getElementById("logo-image").addEventListener("change", function() {
                if (this.files.length === 0) return;
                
                previewImage(this.files[0], function(imageData) {
                    document.getElementById("logo-upload-preview").innerHTML = `
                        <p>LOGO预览:</p>
                        <img src="${imageData}" style="max-width: 200px; margin-top: 10px; border-radius: 5px;">
                    `;
                });
            });
            
            document.getElementById("logo-upload-form").addEventListener("submit", function(e) {
                e.preventDefault();
                
                const file = document.getElementById("logo-image").files[0];
                
                if (!file) {
                    alert("请选择LOGO图片");
                    return;
                }
                
                previewImage(file, function(imageData) {
                    localStorage.setItem("siteLogo", imageData);
                    document.getElementById("site-logo").src = imageData;
                    document.getElementById("logo-preview").src = imageData;
                    hideModal("logo-upload-modal");
                });
            });
            
            // 背景上传
            document.getElementById("bg-image").addEventListener("change", function() {
                if (this.files.length === 0) return;
                
                previewImage(this.files[0], function(imageData) {
                    document.getElementById("bg-upload-preview").innerHTML = `
                        <p>背景预览:</p>
                        <img src="${imageData}" style="max-width: 200px; margin-top: 10px; border-radius: 5px;">
                    `;
                });
            });
            
            document.getElementById("bg-upload-form").addEventListener("submit", function(e) {
                e.preventDefault();
                
                const file = document.getElementById("bg-image").files[0];
                
                if (!file) {
                    alert("请选择背景图片");
                    return;
                }
                
                previewImage(file, function(imageData) {
                    localStorage.setItem("siteBackground", imageData);
                    document.body.style.backgroundImage = `url('${imageData}')`;
                    document.getElementById("bg-preview").src = imageData;
                    hideModal("bg-upload-modal");
                });
            });
            
            // 关闭按钮事件
            document.querySelectorAll(".close-btn, .viewer-close").forEach(btn => {
                btn.addEventListener("click", function() {
                    const modalId = this.closest(".modal, .image-viewer").id;
                    hideModal(modalId);
                });
            });
            
            document.querySelectorAll("#cancel-image, #cancel-diary, #cancel-send, #cancel-register, #cancel-poke, #cancel-logo, #cancel-bg, #cancel-password").forEach(btn => {
                btn.addEventListener("click", function() {
                    const modalId = this.closest(".modal").id;
                    hideModal(modalId);
                });
            });
            
            // 点击模态框外部关闭
            document.querySelectorAll(".modal, .image-viewer").forEach(modal => {
                modal.addEventListener("click", function(e) {
                    if (e.target === this) {
                        hideModal(this.id);
                    }
                });
            });
        }
        
    </script>
</body>
</html>
